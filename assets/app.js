angular.module("winston",["ui.router"]),angular.module("winston").service("apiSVC",["$http",function(a){this.addNew=function(s){return a.post("/api/stats/add",s)},this.remove=function(s){return a.post("/api/stats/remove",s)},this.load=function(){return a.get("/api/stats")}}]),angular.module("winston").controller("mainCTRL",["$scope","apiSVC","preloadObj",function(a,s,t){a._showInput=!1;var n=function(){return[{key:"week",val:null},{key:"date",val:null},{key:"g",val:null},{key:"gs",val:null},{key:"pass_comp",val:null},{key:"pass_att",val:null},{key:"pass_pct",val:null},{key:"pass_yds",val:null},{key:"pass_avg",val:null},{key:"pass_td",val:null},{key:"pass_int",val:null},{key:"pass_sck",val:null},{key:"pass_scky",val:null},{key:"pass_rate",val:null},{key:"rush_att",val:null},{key:"rush_yds",val:null},{key:"rush_avg",val:null},{key:"rush_td",val:null},{key:"fum",val:null},{key:"fum_lost",val:null}]};a.gameStats=t.data.data.winston,a.stats=new n,a.newStats=function(){s.addNew(a.stats).success(function(t){"success"==t.status?(a.stats=new n,a.toggleInput(),s.load().success(function(s){a.gameStats=s.data.winston})):"game_pk"==t.message.constraint?alert("Error: That game already exists in the database. Delete it first if you want to update it"):alert("Error: "+JSON.stringify(t.message.detail))})},a.toggleInput=function(){a._showInput=!a._showInput},a.deleteRow=function(){s.remove({week:$("#row2delete").val().split(" ")[1]}).success(function(t){"success"==t.status&&s.load().success(function(s){a.gameStats=s.data.winston})})},a.maxGames=function(){var s=0;_.forEach(a.players,function(a){a.games.length>s&&(s=a.games.length)});for(var t=[],n=1;s+1>n;n++)t.push(n);return t},a.players=t.data.data.players,a.games=t.data.data.games,_.forEach(a.players,function(s){s.games=[],_.forEach(a.games,function(a){a.player===s.id&&s.games.push(a)})});var e=function(a,s){function t(a){if(null!=a.passing_att&&0!=a.passing_att){var s=5*(e.passing_comp/e.passing_att-.3),t=.25*(e.passing_yds/e.passing_att-3),n=e.passing_td/e.passing_att*20,l=2.375-e.passing_int/e.passing_att*25;return s>2.375&&(s=2.375),0>s&&(s=0),t>2.375&&(t=2.375),0>t&&(t=0),n>2.375&&(n=2.375),0>n&&(n=0),l>2.375&&(l=2.375),0>l&&(l=0),(s+t+n+l)/6*100}}var n=_.take(a.games,s),e={passing_comp:0,passing_yds:0,passing_td:0,passing_att:0,passing_int:0};return _.forEach(n,function(a){null!=a.passing_comp&&(e.passing_comp+=a.passing_comp),null!=a.passing_yds&&(e.passing_yds+=a.passing_yds),null!=a.passing_td&&(e.passing_td+=a.passing_td),null!=a.passing_att&&(e.passing_att+=a.passing_att),null!=a.passing_int&&(e.passing_int+=a.passing_int)}),a.rating=t(e),a};a.ratePlayers=function(){var s=$("#week2rate").val().split(" ")[1];a.rated=[],_.forEach(a.players,function(t){e(t,s),a.rated.push({player:t.name,rating:t.rating,id:"p"+t.id})})}}]),angular.module("winston").config(["$stateProvider",function(a,s){a.state("home",{url:"/",templateUrl:"updateStats.html",controller:"mainCTRL",resolve:{preloadObj:["$http",function(a){return a({method:"GET",url:"/api/stats"})}]}})}]).run(["$state",function(a){a.go("home")}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwaVNWQy5qcyIsIm1haW5DVExSTC5qcyIsInJvdXRlcy5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwic2VydmljZSIsIiRodHRwIiwidGhpcyIsImFkZE5ldyIsIml0ZW0iLCJwb3N0IiwicmVtb3ZlIiwibG9hZCIsImdldCIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCJhcGlTVkMiLCJwcmVsb2FkT2JqIiwiX3Nob3dJbnB1dCIsInN0YXRzIiwia2V5IiwidmFsIiwiZ2FtZVN0YXRzIiwiZGF0YSIsIndpbnN0b24iLCJuZXdTdGF0cyIsInN1Y2Nlc3MiLCJyZXN1bHQiLCJzdGF0dXMiLCJ0b2dnbGVJbnB1dCIsIm1lc3NhZ2UiLCJjb25zdHJhaW50IiwiYWxlcnQiLCJKU09OIiwic3RyaW5naWZ5IiwiZGV0YWlsIiwiZGVsZXRlUm93Iiwid2VlayIsIiQiLCJzcGxpdCIsInJlc3BvbnNlIiwibWF4R2FtZXMiLCJtYXgiLCJfIiwiZm9yRWFjaCIsInBsYXllcnMiLCJwbGF5ZXIiLCJnYW1lcyIsImxlbmd0aCIsIndlZWtzIiwiaSIsInB1c2giLCJnYW1lIiwiaWQiLCJhY2N1bXVsYXRlU3RhdHMiLCJyYXRlIiwicGFzc2luZ19hdHQiLCJhIiwic3RhdHNDdW0iLCJwYXNzaW5nX2NvbXAiLCJiIiwicGFzc2luZ195ZHMiLCJjIiwicGFzc2luZ190ZCIsImQiLCJwYXNzaW5nX2ludCIsInRha2UiLCJyYXRpbmciLCJyYXRlUGxheWVycyIsInJhdGVkIiwibmFtZSIsImNvbmZpZyIsIiRzdGF0ZVByb3ZpZGVyIiwic2VhcmNoU3ZjIiwic3RhdGUiLCJ1cmwiLCJ0ZW1wbGF0ZVVybCIsInJlc29sdmUiLCJtZXRob2QiLCJydW4iLCIkc3RhdGUiLCJnbyJdLCJtYXBwaW5ncyI6IkFBQ0FBLFFBQUFDLE9BQUEsV0FBQSxjQ0RBRCxRQUFBQyxPQUFBLFdBQ0FDLFFBQUEsVUFBQSxRQUFBLFNBQUFDLEdBQ0FDLEtBQUFDLE9BQUEs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QUEsU0FBQUMsRUFBQUMsR0FFQUQsRUFBQUUsTUFBQSxRQUNBQyxJQUFBLElBQ0FDLFlBQUEsbUJBQ0E5RCxXQUFBLFdBQ0ErRCxTQUNBNUQsWUFBQSxRQUFBLFNBQUFYLEdBQ0EsTUFBQUEsSUFBQXdFLE9BQUEsTUFBQUgsSUFBQSx1QkFzQkFJLEtBQUEsU0FBQSxTQUFBQyxHQUVBQSxFQUFBQyxHQUFBIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIFRoaXMgbmVlZHMgdG8gYmUgbG9hZGVkIGZpcnN0IGJlY2F1c2UgaXQgZGVmaW5lcyB0aGUgZGVwZW5kZW5jaWVzLiBUaGUgZ3VscCB0YXNrIHdpbGwgYWx3YXlzIGNvbmNhdCB0aGlzIHRvIHRoZSB0b3Agb2YgZmlsZVxuYW5ndWxhci5tb2R1bGUoJ3dpbnN0b24nLCBbJ3VpLnJvdXRlciddKTsiLCJhbmd1bGFyLm1vZHVsZSgnd2luc3RvbicpXG4uc2VydmljZSgnYXBpU1ZDJywgZnVuY3Rpb24oJGh0dHApIHtcbiAgICAgICAgdGhpcy5hZGROZXcgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvc3RhdHMvYWRkJyxpdGVtKVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLnJlbW92ZSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9zdGF0cy9yZW1vdmUnLGl0ZW0pXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMubG9hZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9zdGF0cycpXG4gICAgICAgIH1cbiAgICB9KTsiLCJhbmd1bGFyLm1vZHVsZSgnd2luc3RvbicpXG4gICAgLmNvbnRyb2xsZXIoJ21haW5DVFJMJyxmdW5jdGlvbigkc2NvcGUsYXBpU1ZDLHByZWxvYWRPYmope1xuICAgICAgICAkc2NvcGUuX3Nob3dJbnB1dCA9IGZhbHNlO1xuICAgICAgICB2YXIgc3RhdHMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBrZXk6ICd3ZWVrJyxcbiAgICAgICAgICAgICAgICAgICAgdmFsOiBudWxsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGtleTogJ2RhdGUnLFxuICAgICAgICAgICAgICAgICAgICB2YWw6IG51bGxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAga2V5OiAnZycsXG4gICAgICAgICAgICAgICAgICAgIHZhbDogbnVsbFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBrZXk6ICdncycsXG4gICAgICAgICAgICAgICAgICAgIHZhbDogbnVsbFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBrZXk6ICdwYXNzX2NvbXAnLFxuICAgICAgICAgICAgICAgICAgICB2YWw6IG51bGxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAga2V5OiAncGFzc19hdHQnLFxuICAgICAgICAgICAgICAgICAgICB2YWw6IG51bGxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAga2V5OiAncGFzc19wY3QnLFxuICAgICAgICAgICAgICAgICAgICB2YWw6IG51bGxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAga2V5OiAncGFzc195ZHMnLFxuICAgICAgICAgICAgICAgICAgICB2YWw6IG51bGxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAga2V5OiAncGFzc19hdmcnLFxuICAgICAgICAgICAgICAgICAgICB2YWw6IG51bGxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAga2V5OiAncGFzc190ZCcsXG4gICAgICAgICAgICAgICAgICAgIHZhbDogbnVsbFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBrZXk6ICdwYXNzX2ludCcsXG4gICAgICAgICAgICAgICAgICAgIHZhbDogbnVsbFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBrZXk6ICdwYXNzX3NjaycsXG4gICAgICAgICAgICAgICAgICAgIHZhbDogbnVsbFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBrZXk6ICdwYXNzX3Nja3knLFxuICAgICAgICAgICAgICAgICAgICB2YWw6IG51bGxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAga2V5OiAncGFzc19yYXRlJyxcbiAgICAgICAgICAgICAgICAgICAgdmFsOiBudWxsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGtleTogJ3J1c2hfYXR0JyxcbiAgICAgICAgICAgICAgICAgICAgdmFsOiBudWxsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGtleTogJ3J1c2hfeWRzJyxcbiAgICAgICAgICAgICAgICAgICAgdmFsOiBudWxsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGtleTogJ3J1c2hfYXZnJyxcbiAgICAgICAgICAgICAgICAgICAgdmFsOiBudWxsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGtleTogJ3J1c2hfdGQnLFxuICAgICAgICAgICAgICAgICAgICB2YWw6IG51bGxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAga2V5OiAnZnVtJyxcbiAgICAgICAgICAgICAgICAgICAgdmFsOiBudWxsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGtleTogJ2Z1bV9sb3N0JyxcbiAgICAgICAgICAgICAgICAgICAgdmFsOiBudWxsXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLmdhbWVTdGF0cyA9IHByZWxvYWRPYmouZGF0YS5kYXRhLndpbnN0b247XG4gICAgICAgICRzY29wZS5zdGF0cyA9IG5ldyBzdGF0cygpO1xuICAgICAgICAkc2NvcGUubmV3U3RhdHMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGFwaVNWQy5hZGROZXcoJHNjb3BlLnN0YXRzKS5zdWNjZXNzKGZ1bmN0aW9uKHJlc3VsdCl7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgPT0gXCJzdWNjZXNzXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN0YXRzID0gbmV3IHN0YXRzKCk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50b2dnbGVJbnB1dCgpO1xuICAgICAgICAgICAgICAgICAgICBhcGlTVkMubG9hZCgpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdhbWVTdGF0cyA9IGRhdGEuZGF0YS53aW5zdG9uO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzdWx0Lm1lc3NhZ2UuY29uc3RyYWludCA9PSAnZ2FtZV9waycpIHtcbiAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCJFcnJvcjogVGhhdCBnYW1lIGFscmVhZHkgZXhpc3RzIGluIHRoZSBkYXRhYmFzZS4gRGVsZXRlIGl0IGZpcnN0IGlmIHlvdSB3YW50IHRvIHVwZGF0ZSBpdFwiKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCJFcnJvcjogXCIgKyBKU09OLnN0cmluZ2lmeShyZXN1bHQubWVzc2FnZS5kZXRhaWwpKVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS50b2dnbGVJbnB1dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgJHNjb3BlLl9zaG93SW5wdXQgPSAhJHNjb3BlLl9zaG93SW5wdXQ7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5kZWxldGVSb3cgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGFwaVNWQy5yZW1vdmUoe3dlZWs6ICQoJyNyb3cyZGVsZXRlJykudmFsKCkuc3BsaXQoJyAnKVsxXX0pLnN1Y2Nlc3MoZnVuY3Rpb24ocmVzcG9uc2Upe1xuICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT0gJ3N1Y2Nlc3MnKSB7XG4gICAgICAgICAgICAgICAgICAgIGFwaVNWQy5sb2FkKCkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2FtZVN0YXRzID0gZGF0YS5kYXRhLndpbnN0b247XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLm1heEdhbWVzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgbWF4ID0gMDtcbiAgICAgICAgICAgIF8uZm9yRWFjaCgkc2NvcGUucGxheWVycywgZnVuY3Rpb24ocGxheWVyKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBsYXllci5nYW1lcy5sZW5ndGggPiBtYXgpIG1heCA9IHBsYXllci5nYW1lcy5sZW5ndGg7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZhciB3ZWVrcyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBtYXggKyAxOyBpKyspIHtcbiAgICAgICAgICAgICAgICB3ZWVrcy5wdXNoKGkpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gd2Vla3M7XG4gICAgICAgIH07XG4gICAgICAgICRzY29wZS5wbGF5ZXJzID0gcHJlbG9hZE9iai5kYXRhLmRhdGEucGxheWVycztcbiAgICAgICAgJHNjb3BlLmdhbWVzID0gcHJlbG9hZE9iai5kYXRhLmRhdGEuZ2FtZXM7XG4gICAgICAgIF8uZm9yRWFjaCgkc2NvcGUucGxheWVycywgZnVuY3Rpb24ocGxheWVyKSB7XG4gICAgICAgICAgICBwbGF5ZXIuZ2FtZXMgPSBbXTtcbiAgICAgICAgICAgIF8uZm9yRWFjaCgkc2NvcGUuZ2FtZXMsIGZ1bmN0aW9uKGdhbWUpIHtcbiAgICAgICAgICAgICAgICBpZiAoZ2FtZS5wbGF5ZXIgPT09IHBsYXllci5pZCkgcGxheWVyLmdhbWVzLnB1c2goZ2FtZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHZhciBhY2N1bXVsYXRlU3RhdHMgPSBmdW5jdGlvbihwbGF5ZXIsIHdlZWspIHtcbiAgICAgICAgICAgIHZhciBnYW1lcyA9IF8udGFrZShwbGF5ZXIuZ2FtZXMsIHdlZWspO1xuICAgICAgICAgICAgdmFyIHN0YXRzQ3VtID0ge1xuICAgICAgICAgICAgICAgIHBhc3NpbmdfY29tcDowLFxuICAgICAgICAgICAgICAgIHBhc3NpbmdfeWRzOiAwLFxuICAgICAgICAgICAgICAgIHBhc3NpbmdfdGQ6IDAsXG4gICAgICAgICAgICAgICAgcGFzc2luZ19hdHQ6IDAsXG4gICAgICAgICAgICAgICAgcGFzc2luZ19pbnQ6IDBcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBfLmZvckVhY2goZ2FtZXMsZnVuY3Rpb24oZ2FtZSkge1xuICAgICAgICAgICAgICAgIGlmIChnYW1lLnBhc3NpbmdfY29tcCAhPSBudWxsKSBzdGF0c0N1bS5wYXNzaW5nX2NvbXAgKz0gZ2FtZS5wYXNzaW5nX2NvbXA7XG4gICAgICAgICAgICAgICAgaWYgKGdhbWUucGFzc2luZ195ZHMgIT0gbnVsbCkgc3RhdHNDdW0ucGFzc2luZ195ZHMgKz0gZ2FtZS5wYXNzaW5nX3lkcztcbiAgICAgICAgICAgICAgICBpZiAoZ2FtZS5wYXNzaW5nX3RkICE9IG51bGwpIHN0YXRzQ3VtLnBhc3NpbmdfdGQgKz0gZ2FtZS5wYXNzaW5nX3RkO1xuICAgICAgICAgICAgICAgIGlmIChnYW1lLnBhc3NpbmdfYXR0ICE9IG51bGwpIHN0YXRzQ3VtLnBhc3NpbmdfYXR0ICs9IGdhbWUucGFzc2luZ19hdHQ7XG4gICAgICAgICAgICAgICAgaWYgKGdhbWUucGFzc2luZ19pbnQgIT0gbnVsbCkgc3RhdHNDdW0ucGFzc2luZ19pbnQgKz0gZ2FtZS5wYXNzaW5nX2ludDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZnVuY3Rpb24gcmF0ZShzdGF0cykge1xuICAgICAgICAgICAgICAgIGlmIChzdGF0cy5wYXNzaW5nX2F0dCAhPSBudWxsICYmIHN0YXRzLnBhc3NpbmdfYXR0ICE9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gZm9ybXVsYSBmcm9tIGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1Bhc3Nlcl9yYXRpbmdcbiAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSAoc3RhdHNDdW0ucGFzc2luZ19jb21wIC8gc3RhdHNDdW0ucGFzc2luZ19hdHQgLSAuMykgKiA1O1xuICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IChzdGF0c0N1bS5wYXNzaW5nX3lkcyAvIHN0YXRzQ3VtLnBhc3NpbmdfYXR0IC0gMykgKiAuMjU7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjID0gKHN0YXRzQ3VtLnBhc3NpbmdfdGQgLyBzdGF0c0N1bS5wYXNzaW5nX2F0dCkgKiAyMDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSAyLjM3NSAtIChzdGF0c0N1bS5wYXNzaW5nX2ludCAvIHN0YXRzQ3VtLnBhc3NpbmdfYXR0ICogMjUpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYSA+IDIuMzc1KSBhID0gMi4zNzU7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhIDwgMCkgYSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIGlmIChiID4gMi4zNzUpIGIgPSAyLjM3NTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGIgPCAwKSBiID0gMDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGMgPiAyLjM3NSkgYyA9IDIuMzc1O1xuICAgICAgICAgICAgICAgICAgICBpZiAoYyA8IDApIGMgPSAwO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZCA+IDIuMzc1KSBkID0gMi4zNzU7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkIDwgMCkgZCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoYSArIGIgKyBjICsgZCkgLyA2ICogMTAwO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGxheWVyLnJhdGluZyA9IHJhdGUoc3RhdHNDdW0pO1xuICAgICAgICAgICAgcmV0dXJuIHBsYXllcjtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLnJhdGVQbGF5ZXJzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgd2VlayA9ICQoJyN3ZWVrMnJhdGUnKS52YWwoKS5zcGxpdCgnICcpWzFdO1xuICAgICAgICAgICAgJHNjb3BlLnJhdGVkID0gW107XG4gICAgICAgICAgICBfLmZvckVhY2goJHNjb3BlLnBsYXllcnMsIGZ1bmN0aW9uKHBsYXllcikge1xuICAgICAgICAgICAgICAgIGFjY3VtdWxhdGVTdGF0cyhwbGF5ZXIsd2Vlayk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnJhdGVkLnB1c2goe1wicGxheWVyXCI6cGxheWVyLm5hbWUsXCJyYXRpbmdcIjpwbGF5ZXIucmF0aW5nLFwiaWRcIjpcInBcIitwbGF5ZXIuaWR9KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG4iLCJhbmd1bGFyLm1vZHVsZSgnd2luc3RvbicpXG4gICAgLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJyxmdW5jdGlvbigkc3RhdGVQcm92aWRlciwgc2VhcmNoU3ZjKXtcbiAgICAgICAgLy8gVGhlc2Ugc3RhdGVzIGNvcnJlc3BvbmQgdG8gdGhlIHBhZ2VzIG9uIHRoZSBhcHAuIEhvb2tzIHVwIHRlbXBsYXRlcyBhbmQgdmlld3NcbiAgICAgICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoJ2hvbWUnLHtcbiAgICAgICAgICAgIHVybDogJy8nLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd1cGRhdGVTdGF0cy5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdtYWluQ1RSTCcsXG4gICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgICAgcHJlbG9hZE9iajogZnVuY3Rpb24oJGh0dHApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRodHRwKHttZXRob2Q6J0dFVCcsdXJsOicvYXBpL3N0YXRzJ30pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vLnN0YXRlKCdzZWFyY2gnLHtcbiAgICAgICAgICAgIC8vICAgIHVybDogJy9zZWFyY2gnLFxuICAgICAgICAgICAgLy8gICAgdGVtcGxhdGVVcmw6ICdzZWFyY2guaHRtbCcsXG4gICAgICAgICAgICAvLyAgICBjb250cm9sbGVyOiAnc2VhcmNoQ1RSTCcsXG4gICAgICAgICAgICAvLyAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAvLyAgICAgICAgLy8gVGhpcyBxdWVyaWVzIHRoZSBzZXJ2ZXIgZm9yIGRpc3RpbmN0IGRlcGFydG1lbnRzIGFuZCBwcmVsb2FkcyB0aGUgZGVwYXJ0bWVudHMgZHJvcCBkb3duXG4gICAgICAgICAgICAvLyAgICAgICAgcHJlbG9hZE9CSjogZnVuY3Rpb24oJGh0dHApIHtcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgcmV0dXJuICRodHRwKHttZXRob2Q6J0dFVCcsdXJsOicvYXBpL2RlcGFydG1lbnRzJ30pO1xuICAgICAgICAgICAgLy8gICAgICAgIH1cbiAgICAgICAgICAgIC8vICAgIH1cbiAgICAgICAgICAgIC8vfSlcbiAgICAgICAgICAgIC8vLnN0YXRlKCdkZXRhaWxzJyx7XG4gICAgICAgICAgICAvLyAgICAvLyBUaGUgOmlkIGlzIHRoZSBzdHJpbmcgcGFzc2VkIGluIGZyb20gdGhlIFVSTCBjb3JyZXNwb25kcyB0byB0aGUgcGVyc29uSUQgaW4gdGhlIHRoZSBkYXRhYmFzZVxuICAgICAgICAgICAgLy8gICAgdXJsOiAnL2RldGFpbHMvOmlkJyxcbiAgICAgICAgICAgIC8vICAgIHRlbXBsYXRlVXJsOiAnZGV0YWlscy5odG1sJyxcbiAgICAgICAgICAgIC8vICAgIGNvbnRyb2xsZXI6ICdkZXRhaWxDVFJMJ1xuICAgICAgICAgICAgLy99KVxuICAgIH1dKVxuICAgIC5ydW4oWyckc3RhdGUnLGZ1bmN0aW9uKCRzdGF0ZSl7XG4gICAgICAgIC8vIEV2ZXJ5dGhpbmcgaW5zaWRlIGhlcmUgd2lsbCBiZSBydW4gb25lIHRpbWUgb25jZSB0aGUgYXBwIGhhcyBsb2FkZWQuIEdvb2QgcGxhY2UgdG8gaW5pdGlhbGl6ZSBhbnl0aGluZyB5b3Ugd2lsbCBiZSB1c2luZ1xuICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKTtcbiAgICB9XSk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=