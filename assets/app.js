angular.module("winston",["ui.router"]),angular.module("winston").service("apiSVC",["$http",function(a){this.addNew=function(s){return a.post("/api/stats/add",s)},this.remove=function(){return a.get("/api/stats/remove")},this.load=function(){return a.get("/api/stats")}}]),angular.module("winston").controller("mainCTRL",["$scope","apiSVC","preloadObj",function(a,s,t){a._showInput=!1;var n=function(){return[{key:"week",val:null},{key:"date",val:null},{key:"g",val:null},{key:"gs",val:null},{key:"pass_comp",val:null},{key:"pass_att",val:null},{key:"pass_pct",val:null},{key:"pass_yds",val:null},{key:"pass_avg",val:null},{key:"pass_td",val:null},{key:"pass_int",val:null},{key:"pass_sck",val:null},{key:"pass_scky",val:null},{key:"pass_rate",val:null},{key:"rush_att",val:null},{key:"rush_yds",val:null},{key:"rush_avg",val:null},{key:"rush_td",val:null},{key:"fum",val:null},{key:"fum_lost",val:null}]},l=function(){return[{key:"date",val:null},{key:"g",val:null},{key:"gs",val:null},{key:"pass_comp",val:null},{key:"pass_att",val:null},{key:"pass_pct",val:null},{key:"pass_yds",val:null},{key:"pass_avg",val:null},{key:"pass_td",val:null},{key:"pass_int",val:null},{key:"pass_sck",val:null},{key:"pass_scky",val:null},{key:"pass_rate",val:null},{key:"rush_att",val:null},{key:"rush_yds",val:null},{key:"rush_avg",val:null},{key:"rush_td",val:null},{key:"fum",val:null},{key:"fum_lost",val:null}]};"err"==t.data.status&&console.log(t.data.message),a.gameStats=t.data.data.winston,a.stats=new n,a.Ustats=new l,a.newStats=function(){s.addNew(a.Ustats).success(function(t){"success"==t.status?(a.Ustats=new l,a.toggleInput(),s.load().success(function(s){a.gameStats=s.data.winston})):"game_pk"==t.message.constraint?alert("Error: That game already exists in the database. Delete it first if you want to update it"):alert("Error: "+JSON.stringify(t.message.detail))})},a.toggleInput=function(){a._showInput=!a._showInput},a.deleteRow=function(){0!=a.gameStats&&s.remove().success(function(t){"success"==t.status&&s.load().success(function(s){a.gameStats=s.data.winston})})},a.maxGames=function(){var s=0;_.forEach(a.players,function(a){a.games.length>s&&(s=a.games.length)});for(var t=[],n=1;s+1>n;n++)t.push(n);return t},a.players=t.data.data.players,a.games=t.data.data.games,_.forEach(a.players,function(s){s.games=[],_.forEach(a.games,function(a){a.player===s.id&&s.games.push(a)})});var e=function(a,s){function t(a){if(null!=a.passing_att&&0!=a.passing_att){var s=5*(l.passing_comp/l.passing_att-.3),t=.25*(l.passing_yds/l.passing_att-3),n=l.passing_td/l.passing_att*20,e=2.375-l.passing_int/l.passing_att*25;return s>2.375&&(s=2.375),0>s&&(s=0),t>2.375&&(t=2.375),0>t&&(t=0),n>2.375&&(n=2.375),0>n&&(n=0),e>2.375&&(e=2.375),0>e&&(e=0),(s+t+n+e)/6*100}}var n=_.take(a.games,s),l={passing_comp:0,passing_yds:0,passing_td:0,passing_att:0,passing_int:0};return _.forEach(n,function(a){null!=a.passing_comp&&(l.passing_comp+=a.passing_comp),null!=a.passing_yds&&(l.passing_yds+=a.passing_yds),null!=a.passing_td&&(l.passing_td+=a.passing_td),null!=a.passing_att&&(l.passing_att+=a.passing_att),null!=a.passing_int&&(l.passing_int+=a.passing_int)}),a.rating=t(l),a};a.ratePlayers=function(){var t=$("#week2rate").val().split(" ")[1],n=[];a.rated=[],s.load().success(function(s){a.players=s.data.players,a.games=s.data.games,a.gameStates=s.data.winston,_.forEach(a.players,function(s){s.games=[],_.forEach(a.games,function(a){a.player===s.id&&s.games.push(a)})}),_.forEach(a.players,function(a){e(a,t),n.push({player:a.name,rating:Math.round(100*(a.rating+1e-5))/100,id:"p"+a.id})});var l=_.sortBy(n,function(a){return a.rating});l=_.filter(l,function(a){return a.rating}),_.forEach(l.reverse(),function(s,t){s.rank=t+1,a.rated.push(s)})})}}]),angular.module("winston").config(["$stateProvider",function(a,s){a.state("home",{url:"/",templateUrl:"updateStats.html",controller:"mainCTRL",resolve:{preloadObj:["$http",function(a){return a({method:"GET",url:"/api/stats"})}]}})}]).run(["$state",function(a){a.go("home")}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwaVNWQy5qcyIsIm1haW5DVExSTC5qcyIsInJvdXRlcy5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwic2VydmljZSIsIiRodHRwIiwidGhpcyIsImFkZE5ldyIsIml0ZW0iLCJwb3N0IiwicmVtb3ZlIiwiZ2V0IiwibG9hZCIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCJhcGlTVkMiLCJwcmVsb2FkT2JqIiwiX3Nob3dJbnB1dCIsInN0YXRzIiwia2V5IiwidmFsIiwiVXN0YXRzIiwiZGF0YSIsInN0YXR1cyIsImNvbnNvbGUiLCJsb2ciLCJtZXNzYWdlIiwiZ2FtZVN0YXRzIiwid2luc3RvbiIsIm5ld1N0YXRzIiwic3VjY2VzcyIsInJlc3VsdCIsInRvZ2dsZUlucHV0IiwiY29uc3RyYWludCIsImFsZXJ0IiwiSlNPTiIsInN0cmluZ2lmeSIsImRldGFpbCIsImRlbGV0ZVJvdyIsInJlc3BvbnNlIiwibWF4R2FtZXMiLCJtYXgiLCJfIiwiZm9yRWFjaCIsInBsYXllcnMiLCJwbGF5ZXIiLCJnYW1lcyIsImxlbmd0aCIsIndlZWtzIiwiaSIsInB1c2giLCJnYW1lIiwiaWQiLCJhY2N1bXVsYXRlU3RhdHMiLCJ3ZWVrIiwicmF0ZSIsInBhc3NpbmdfYXR0IiwiYSIsInN0YXRzQ3VtIiwicGFzc2luZ19jb21wIiwiYiIsInBhc3NpbmdfeWRzIiwiYyIsInBhc3NpbmdfdGQiLCJkIiwicGFzc2luZ19pbnQiLCJ0YWtlIiwicmF0aW5nIiwicmF0ZVBsYXllcnMiLCIkIiwic3BsaXQiLCJyYXRlZCIsInBsYXllcnNPYmoiLCJnYW1lU3RhdGVzIiwibmFtZSIsIk1hdGgiLCJyb3VuZCIsInJhbmtlZCIsInNvcnRCeSIsImZpbHRlciIsInAiLCJyZXZlcnNlIiwiaW5kZXgiLCJyYW5rIiwiY29uZmlnIiwiJHN0YXRlUHJvdmlkZXIiLCJzZWFyY2hTdmMiLCJzdGF0ZSIsInVybCIsInRlbXBsYXRlVXJsIiwicmVzb2x2ZSIsIm1ldGhvZCIsInJ1biIsIiRzdGF0ZSIsImdvIl0sIm1hcHBpbmdzIjoiQUFDQUEsUUFBQUMsT0FBQSxXQUFBLGNDREFELFFBQUFDLE9BQUEsV0FDQUMsUUFBQSxVQUFBLFFBQUEsU0FBQUMsR0FDQUMsS0FBQUMsT0FBQSxTQUFBQyxHQUNBLE1BQUFILEdBQUFJLEtBQUEsaUJBQUFELElBRUFGLEtBQUFJLE9BQUEsV0FDQSxNQUFBTCxHQUFBTSxJQUFBLHNCQUVBTCxLQUFBTSxLQUFBLFdBQ0EsTUFBQVAsR0FBQU0sSUFBQSxrQkNUQVQsUUFBQUMsT0FBQSxXQUNBVSxXQUFBLFlBQUEsU0FBQSxTQUFBLGFBQUEsU0FBQUMsRUFBQUMsRUFBQUMsR0FDQUYsRUFBQUcsWUFBQSxDQUNBLElBQUFDLEdBQUEsV0FDQSxRQUVBQyxJQUFBLE9BQ0FDLElBQUEsT0FHQUQsSUFBQSxPQUNBQyxJQUFBLE9BR0FELElBQUEsSUFDQUMsSUFBQSxPQUdBRCxJQUFBLEtBQ0FDLElBQUEsT0FHQUQsSUFBQSxZQUNBQyxJQUFBLE9BR0FELElBQUEsV0FDQUMsSUFBQSxPQUdBRCxJQUFBLFdBQ0FDLElBQUEsT0FHQUQsSUFBQSxXQUNBQyxJQUFBLE9BR0FELElBQUEsV0FDQUMsSUFBQSxPQUdBRCxJQUFBLFVBQ0FDLElBQUEsT0FHQUQsSUFBQSxXQUNBQyxJQUFBLE9BR0FELElBQUEsV0FDQUMsSUFBQSxPQUdBRCxJQUFBLFlBQ0FDLElBQUEsT0FHQUQsSUFBQSxZQUNBQyxJQUFBLE9BR0FELElBQUEsV0FDQUMsSUFBQSxPQUdBRCxJQUFBLFdBQ0FDLElBQUEsT0FHQUQsSUFBQSxXQUNBQyxJQUFBLE9BR0FELElBQUEsVUFDQUMsSUFBQSxPQUdBRCxJQUFBLE1BQ0FDLElBQUEsT0FHQUQsSUFBQSxXQUNBQyxJQUFBLFFBSUFDLEVBQUEsV0FDQSxRQUVBRixJQUFBLE9BQ0FDLElBQUEsT0FHQUQsSUFBQSxJQUNBQyxJQUFBLE9BR0FELElBQUEsS0FDQUMsSUFBQSxPQUdBRCxJQUFBLFlBQ0FDLElBQUEsT0FHQUQsSUFBQSxXQUNBQyxJQUFBLE9BR0FELElBQUEsV0FDQUMsSUFBQSxPQUdBRCxJQUFBLFdBQ0FDLElBQUEsT0FHQUQsSUFBQSxXQUNBQyxJQUFBLE9BR0FELElBQUEsVUFDQUMsSUFBQSxPQUdBRCxJQUFBLFdBQ0FDLElBQUEsT0FHQUQsSUFBQSxXQUNBQyxJQUFBLE9BR0FELElBQUEsWUFDQUMsSUFBQSxPQUdBRCxJQUFBLFlBQ0FDLElBQUEsT0FHQUQsSUFBQSxXQUNBQyxJQUFBLE9BR0FELElBQUEsV0FDQUMsSUFBQSxPQUdBRCxJQUFBLFdBQ0FDLElBQUEsT0FHQUQsSUFBQSxVQUNBQyxJQUFBLE9BR0FELElBQUEsTUFDQUMsSUFBQSxPQUdBRCxJQUFBLFdBQ0FDLElBQUEsT0FJQSxRQUFBSixFQUFBTSxLQUFBQyxRQUFBQyxRQUFBQyxJQUFBVCxFQUFBTSxLQUFBSSxTQUNBWixFQUFBYSxVQUFBWCxFQUFBTSxLQUFBQSxLQUFBTSxRQUNBZCxFQUFBSSxNQUFBLEdBQUFBLEdBQ0FKLEVBQUFPLE9BQUEsR0FBQUEsR0FDQVAsRUFBQWUsU0FBQSxXQUNBZCxFQUFBUixPQUFBTyxFQUFBTyxRQUFBUyxRQUFBLFNBQUFDLEdBQ0EsV0FBQUEsRUFBQVIsUUFDQVQsRUFBQU8sT0FBQSxHQUFBQSxHQUNBUCxFQUFBa0IsY0FDQWpCLEVBQUFILE9BQUFrQixRQUFBLFNBQUFSLEdBQ0FSLEVBQUFhLFVBQUFMLEVBQUFBLEtBQUFNLFdBRUEsV0FBQUcsRUFBQUwsUUFBQU8sV0FDQUMsTUFBQSw2RkFHQUEsTUFBQSxVQUFBQyxLQUFBQyxVQUFBTCxFQUFBTCxRQUFBVyxZQUtBdkIsRUFBQWtCLFlBQUEsV0FDQWxCLEVBQUFHLFlBQUFILEVBQUFHLFlBRUFILEVBQUF3QixVQUFBLFdBQ0EsR0FBQXhCLEVBQUFhLFdBQ0FaLEVBQUFMLFNBQUFvQixRQUFBLFNBQUFTLEdBQ0EsV0FBQUEsRUFBQWhCLFFBQ0FSLEVBQUFILE9BQUFrQixRQUFBLFNBQUFSLEdBQ0FSLEVBQUFhLFVBQUFMLEVBQUFBLEtBQUFNLGFBTUFkLEVBQUEwQixTQUFBLFdBQ0EsR0FBQUMsR0FBQSxDQUNBQyxHQUFBQyxRQUFBN0IsRUFBQThCLFFBQUEsU0FBQUMsR0FDQUEsRUFBQUMsTUFBQUMsT0FBQU4sSUFBQUEsRUFBQUksRUFBQUMsTUFBQUMsU0FHQSxLQUFBLEdBREFDLE1BQ0FDLEVBQUEsRUFBQVIsRUFBQSxFQUFBUSxFQUFBQSxJQUNBRCxFQUFBRSxLQUFBRCxFQUVBLE9BQUFELElBRUFsQyxFQUFBOEIsUUFBQTVCLEVBQUFNLEtBQUFBLEtBQUFzQixRQUNBOUIsRUFBQWdDLE1BQUE5QixFQUFBTSxLQUFBQSxLQUFBd0IsTUFDQUosRUFBQUMsUUFBQTdCLEVBQUE4QixRQUFBLFNBQUFDLEdBQ0FBLEVBQUFDLFNBQ0FKLEVBQUFDLFFBQUE3QixFQUFBZ0MsTUFBQSxTQUFBSyxHQUNBQSxFQUFBTixTQUFBQSxFQUFBTyxJQUFBUCxFQUFBQyxNQUFBSSxLQUFBQyxNQUdBLElBQUFFLEdBQUEsU0FBQVIsRUFBQVMsR0FnQkEsUUFBQUMsR0FBQXJDLEdBQ0EsR0FBQSxNQUFBQSxFQUFBc0MsYUFBQSxHQUFBdEMsRUFBQXNDLFlBQUEsQ0FFQSxHQUFBQyxHQUFBLEdBQUFDLEVBQUFDLGFBQUFELEVBQUFGLFlBQUEsSUFDQUksRUFBQSxLQUFBRixFQUFBRyxZQUFBSCxFQUFBRixZQUFBLEdBQ0FNLEVBQUFKLEVBQUFLLFdBQUFMLEVBQUFGLFlBQUEsR0FDQVEsRUFBQSxNQUFBTixFQUFBTyxZQUFBUCxFQUFBRixZQUFBLEVBU0EsT0FSQUMsR0FBQSxRQUFBQSxFQUFBLE9BQ0EsRUFBQUEsSUFBQUEsRUFBQSxHQUNBRyxFQUFBLFFBQUFBLEVBQUEsT0FDQSxFQUFBQSxJQUFBQSxFQUFBLEdBQ0FFLEVBQUEsUUFBQUEsRUFBQSxPQUNBLEVBQUFBLElBQUFBLEVBQUEsR0FDQUUsRUFBQSxRQUFBQSxFQUFBLE9BQ0EsRUFBQUEsSUFBQUEsRUFBQSxJQUNBUCxFQUFBRyxFQUFBRSxFQUFBRSxHQUFBLEVBQUEsS0E5QkEsR0FBQWxCLEdBQUFKLEVBQUF3QixLQUFBckIsRUFBQUMsTUFBQVEsR0FDQUksR0FDQUMsYUFBQSxFQUNBRSxZQUFBLEVBQ0FFLFdBQUEsRUFDQVAsWUFBQSxFQUNBUyxZQUFBLEVBNkJBLE9BM0JBdkIsR0FBQUMsUUFBQUcsRUFBQSxTQUFBSyxHQUNBLE1BQUFBLEVBQUFRLGVBQUFELEVBQUFDLGNBQUFSLEVBQUFRLGNBQ0EsTUFBQVIsRUFBQVUsY0FBQUgsRUFBQUcsYUFBQVYsRUFBQVUsYUFDQSxNQUFBVixFQUFBWSxhQUFBTCxFQUFBSyxZQUFBWixFQUFBWSxZQUNBLE1BQUFaLEVBQUFLLGNBQUFFLEVBQUFGLGFBQUFMLEVBQUFLLGFBQ0EsTUFBQUwsRUFBQWMsY0FBQVAsRUFBQU8sYUFBQWQsRUFBQWMsZUFxQkFwQixFQUFBc0IsT0FBQVosRUFBQUcsR0FDQWIsRUFFQS9CLEdBQUFzRCxZQUFBLFdBQ0EsR0FBQWQsR0FBQWUsRUFBQSxjQUFBakQsTUFBQWtELE1BQUEsS0FBQSxHQUNBQyxJQUNBekQsR0FBQXlELFNBQ0F4RCxFQUFBSCxPQUFBa0IsUUFBQSxTQUFBMEMsR0FDQTFELEVBQUE4QixRQUFBNEIsRUFBQWxELEtBQUFzQixRQUNBOUIsRUFBQWdDLE1BQUEwQixFQUFBbEQsS0FBQXdCLE1BQ0FoQyxFQUFBMkQsV0FBQUQsRUFBQWxELEtBQUFNLFFBQ0FjLEVBQUFDLFFBQUE3QixFQUFBOEIsUUFBQSxTQUFBQyxHQUNBQSxFQUFBQyxTQUNBSixFQUFBQyxRQUFBN0IsRUFBQWdDLE1BQUEsU0FBQUssR0FDQUEsRUFBQU4sU0FBQUEsRUFBQU8sSUFBQVAsRUFBQUMsTUFBQUksS0FBQUMsT0FHQVQsRUFBQUMsUUFBQTdCLEVBQUE4QixRQUFBLFNBQUFDLEdBQ0FRLEVBQUFSLEVBQUFTLEdBQ0FpQixFQUFBckIsTUFDQUwsT0FBQUEsRUFBQTZCLEtBQ0FQLE9BQUFRLEtBQUFDLE1BQUEsS0FBQS9CLEVBQUFzQixPQUFBLE9BQUEsSUFDQWYsR0FBQSxJQUFBUCxFQUFBTyxNQUdBLElBQUF5QixHQUFBbkMsRUFBQW9DLE9BQUFQLEVBQUEsU0FBQTFCLEdBQ0EsTUFBQUEsR0FBQXNCLFFBRUFVLEdBQUFuQyxFQUFBcUMsT0FBQUYsRUFBQSxTQUFBRyxHQUNBLE1BQUFBLEdBQUFiLFNBRUF6QixFQUFBQyxRQUFBa0MsRUFBQUksVUFBQSxTQUFBcEMsRUFBQXFDLEdBQ0FyQyxFQUFBc0MsS0FBQUQsRUFBQSxFQUNBcEUsRUFBQXlELE1BQUFyQixLQUFBTCxXQ2pTQTNDLFFBQUFDLE9BQUEsV0FDQWlGLFFBQUEsaUJBQUEsU0FBQUMsRUFBQUMsR0FFQUQsRUFBQUUsTUFBQSxRQUNBQyxJQUFBLElBQ0FDLFlBQUEsbUJBQ0E1RSxXQUFBLFdBQ0E2RSxTQUNBMUUsWUFBQSxRQUFBLFNBQUFYLEdBQ0EsTUFBQUEsSUFBQXNGLE9BQUEsTUFBQUgsSUFBQSx1QkFzQkFJLEtBQUEsU0FBQSxTQUFBQyxHQUVBQSxFQUFBQyxHQUFBIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIFRoaXMgbmVlZHMgdG8gYmUgbG9hZGVkIGZpcnN0IGJlY2F1c2UgaXQgZGVmaW5lcyB0aGUgZGVwZW5kZW5jaWVzLiBUaGUgZ3VscCB0YXNrIHdpbGwgYWx3YXlzIGNvbmNhdCB0aGlzIHRvIHRoZSB0b3Agb2YgZmlsZVxuYW5ndWxhci5tb2R1bGUoJ3dpbnN0b24nLCBbJ3VpLnJvdXRlciddKTsiLCJhbmd1bGFyLm1vZHVsZSgnd2luc3RvbicpXG4uc2VydmljZSgnYXBpU1ZDJywgZnVuY3Rpb24oJGh0dHApIHtcbiAgICAgICAgdGhpcy5hZGROZXcgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvc3RhdHMvYWRkJyxpdGVtKVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLnJlbW92ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvc3RhdHMvcmVtb3ZlJylcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5sb2FkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3N0YXRzJylcbiAgICAgICAgfVxuICAgIH0pOyIsImFuZ3VsYXIubW9kdWxlKCd3aW5zdG9uJylcbiAgICAuY29udHJvbGxlcignbWFpbkNUUkwnLGZ1bmN0aW9uKCRzY29wZSxhcGlTVkMscHJlbG9hZE9iail7XG4gICAgICAgICRzY29wZS5fc2hvd0lucHV0ID0gZmFsc2U7XG4gICAgICAgIHZhciBzdGF0cyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGtleTogJ3dlZWsnLFxuICAgICAgICAgICAgICAgICAgICB2YWw6IG51bGxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAga2V5OiAnZGF0ZScsXG4gICAgICAgICAgICAgICAgICAgIHZhbDogbnVsbFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBrZXk6ICdnJyxcbiAgICAgICAgICAgICAgICAgICAgdmFsOiBudWxsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGtleTogJ2dzJyxcbiAgICAgICAgICAgICAgICAgICAgdmFsOiBudWxsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGtleTogJ3Bhc3NfY29tcCcsXG4gICAgICAgICAgICAgICAgICAgIHZhbDogbnVsbFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBrZXk6ICdwYXNzX2F0dCcsXG4gICAgICAgICAgICAgICAgICAgIHZhbDogbnVsbFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBrZXk6ICdwYXNzX3BjdCcsXG4gICAgICAgICAgICAgICAgICAgIHZhbDogbnVsbFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBrZXk6ICdwYXNzX3lkcycsXG4gICAgICAgICAgICAgICAgICAgIHZhbDogbnVsbFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBrZXk6ICdwYXNzX2F2ZycsXG4gICAgICAgICAgICAgICAgICAgIHZhbDogbnVsbFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBrZXk6ICdwYXNzX3RkJyxcbiAgICAgICAgICAgICAgICAgICAgdmFsOiBudWxsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGtleTogJ3Bhc3NfaW50JyxcbiAgICAgICAgICAgICAgICAgICAgdmFsOiBudWxsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGtleTogJ3Bhc3Nfc2NrJyxcbiAgICAgICAgICAgICAgICAgICAgdmFsOiBudWxsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGtleTogJ3Bhc3Nfc2NreScsXG4gICAgICAgICAgICAgICAgICAgIHZhbDogbnVsbFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBrZXk6ICdwYXNzX3JhdGUnLFxuICAgICAgICAgICAgICAgICAgICB2YWw6IG51bGxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAga2V5OiAncnVzaF9hdHQnLFxuICAgICAgICAgICAgICAgICAgICB2YWw6IG51bGxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAga2V5OiAncnVzaF95ZHMnLFxuICAgICAgICAgICAgICAgICAgICB2YWw6IG51bGxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAga2V5OiAncnVzaF9hdmcnLFxuICAgICAgICAgICAgICAgICAgICB2YWw6IG51bGxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAga2V5OiAncnVzaF90ZCcsXG4gICAgICAgICAgICAgICAgICAgIHZhbDogbnVsbFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBrZXk6ICdmdW0nLFxuICAgICAgICAgICAgICAgICAgICB2YWw6IG51bGxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAga2V5OiAnZnVtX2xvc3QnLFxuICAgICAgICAgICAgICAgICAgICB2YWw6IG51bGxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgVXN0YXRzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAga2V5OiAnZGF0ZScsXG4gICAgICAgICAgICAgICAgICAgIHZhbDogbnVsbFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBrZXk6ICdnJyxcbiAgICAgICAgICAgICAgICAgICAgdmFsOiBudWxsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGtleTogJ2dzJyxcbiAgICAgICAgICAgICAgICAgICAgdmFsOiBudWxsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGtleTogJ3Bhc3NfY29tcCcsXG4gICAgICAgICAgICAgICAgICAgIHZhbDogbnVsbFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBrZXk6ICdwYXNzX2F0dCcsXG4gICAgICAgICAgICAgICAgICAgIHZhbDogbnVsbFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBrZXk6ICdwYXNzX3BjdCcsXG4gICAgICAgICAgICAgICAgICAgIHZhbDogbnVsbFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBrZXk6ICdwYXNzX3lkcycsXG4gICAgICAgICAgICAgICAgICAgIHZhbDogbnVsbFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBrZXk6ICdwYXNzX2F2ZycsXG4gICAgICAgICAgICAgICAgICAgIHZhbDogbnVsbFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBrZXk6ICdwYXNzX3RkJyxcbiAgICAgICAgICAgICAgICAgICAgdmFsOiBudWxsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGtleTogJ3Bhc3NfaW50JyxcbiAgICAgICAgICAgICAgICAgICAgdmFsOiBudWxsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGtleTogJ3Bhc3Nfc2NrJyxcbiAgICAgICAgICAgICAgICAgICAgdmFsOiBudWxsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGtleTogJ3Bhc3Nfc2NreScsXG4gICAgICAgICAgICAgICAgICAgIHZhbDogbnVsbFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBrZXk6ICdwYXNzX3JhdGUnLFxuICAgICAgICAgICAgICAgICAgICB2YWw6IG51bGxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAga2V5OiAncnVzaF9hdHQnLFxuICAgICAgICAgICAgICAgICAgICB2YWw6IG51bGxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAga2V5OiAncnVzaF95ZHMnLFxuICAgICAgICAgICAgICAgICAgICB2YWw6IG51bGxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAga2V5OiAncnVzaF9hdmcnLFxuICAgICAgICAgICAgICAgICAgICB2YWw6IG51bGxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAga2V5OiAncnVzaF90ZCcsXG4gICAgICAgICAgICAgICAgICAgIHZhbDogbnVsbFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBrZXk6ICdmdW0nLFxuICAgICAgICAgICAgICAgICAgICB2YWw6IG51bGxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAga2V5OiAnZnVtX2xvc3QnLFxuICAgICAgICAgICAgICAgICAgICB2YWw6IG51bGxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdO1xuICAgICAgICB9O1xuICAgICAgICBpZiAocHJlbG9hZE9iai5kYXRhLnN0YXR1cyA9PSAnZXJyJykgY29uc29sZS5sb2cocHJlbG9hZE9iai5kYXRhLm1lc3NhZ2UpO1xuICAgICAgICAkc2NvcGUuZ2FtZVN0YXRzID0gcHJlbG9hZE9iai5kYXRhLmRhdGEud2luc3RvbjtcbiAgICAgICAgJHNjb3BlLnN0YXRzID0gbmV3IHN0YXRzKCk7XG4gICAgICAgICRzY29wZS5Vc3RhdHMgPSBuZXcgVXN0YXRzKCk7XG4gICAgICAgICRzY29wZS5uZXdTdGF0cyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgYXBpU1ZDLmFkZE5ldygkc2NvcGUuVXN0YXRzKS5zdWNjZXNzKGZ1bmN0aW9uKHJlc3VsdCl7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zdGF0dXMgPT0gXCJzdWNjZXNzXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLlVzdGF0cyA9IG5ldyBVc3RhdHMoKTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRvZ2dsZUlucHV0KCk7XG4gICAgICAgICAgICAgICAgICAgIGFwaVNWQy5sb2FkKCkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2FtZVN0YXRzID0gZGF0YS5kYXRhLndpbnN0b247XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXN1bHQubWVzc2FnZS5jb25zdHJhaW50ID09ICdnYW1lX3BrJykge1xuICAgICAgICAgICAgICAgICAgICBhbGVydChcIkVycm9yOiBUaGF0IGdhbWUgYWxyZWFkeSBleGlzdHMgaW4gdGhlIGRhdGFiYXNlLiBEZWxldGUgaXQgZmlyc3QgaWYgeW91IHdhbnQgdG8gdXBkYXRlIGl0XCIpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBhbGVydChcIkVycm9yOiBcIiArIEpTT04uc3RyaW5naWZ5KHJlc3VsdC5tZXNzYWdlLmRldGFpbCkpXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLnRvZ2dsZUlucHV0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkc2NvcGUuX3Nob3dJbnB1dCA9ICEkc2NvcGUuX3Nob3dJbnB1dDtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLmRlbGV0ZVJvdyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgaWYgKCRzY29wZS5nYW1lU3RhdHMgIT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICBhcGlTVkMucmVtb3ZlKCkuc3VjY2VzcyhmdW5jdGlvbihyZXNwb25zZSl7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT0gJ3N1Y2Nlc3MnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcGlTVkMubG9hZCgpLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5nYW1lU3RhdHMgPSBkYXRhLmRhdGEud2luc3RvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUubWF4R2FtZXMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBtYXggPSAwO1xuICAgICAgICAgICAgXy5mb3JFYWNoKCRzY29wZS5wbGF5ZXJzLCBmdW5jdGlvbihwbGF5ZXIpIHtcbiAgICAgICAgICAgICAgICBpZiAocGxheWVyLmdhbWVzLmxlbmd0aCA+IG1heCkgbWF4ID0gcGxheWVyLmdhbWVzLmxlbmd0aDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFyIHdlZWtzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IG1heCArIDE7IGkrKykge1xuICAgICAgICAgICAgICAgIHdlZWtzLnB1c2goaSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB3ZWVrcztcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLnBsYXllcnMgPSBwcmVsb2FkT2JqLmRhdGEuZGF0YS5wbGF5ZXJzO1xuICAgICAgICAkc2NvcGUuZ2FtZXMgPSBwcmVsb2FkT2JqLmRhdGEuZGF0YS5nYW1lcztcbiAgICAgICAgXy5mb3JFYWNoKCRzY29wZS5wbGF5ZXJzLCBmdW5jdGlvbihwbGF5ZXIpIHtcbiAgICAgICAgICAgIHBsYXllci5nYW1lcyA9IFtdO1xuICAgICAgICAgICAgXy5mb3JFYWNoKCRzY29wZS5nYW1lcywgZnVuY3Rpb24oZ2FtZSkge1xuICAgICAgICAgICAgICAgIGlmIChnYW1lLnBsYXllciA9PT0gcGxheWVyLmlkKSBwbGF5ZXIuZ2FtZXMucHVzaChnYW1lKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgdmFyIGFjY3VtdWxhdGVTdGF0cyA9IGZ1bmN0aW9uKHBsYXllciwgd2Vlaykge1xuICAgICAgICAgICAgdmFyIGdhbWVzID0gXy50YWtlKHBsYXllci5nYW1lcywgd2Vlayk7XG4gICAgICAgICAgICB2YXIgc3RhdHNDdW0gPSB7XG4gICAgICAgICAgICAgICAgcGFzc2luZ19jb21wOjAsXG4gICAgICAgICAgICAgICAgcGFzc2luZ195ZHM6IDAsXG4gICAgICAgICAgICAgICAgcGFzc2luZ190ZDogMCxcbiAgICAgICAgICAgICAgICBwYXNzaW5nX2F0dDogMCxcbiAgICAgICAgICAgICAgICBwYXNzaW5nX2ludDogMFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIF8uZm9yRWFjaChnYW1lcyxmdW5jdGlvbihnYW1lKSB7XG4gICAgICAgICAgICAgICAgaWYgKGdhbWUucGFzc2luZ19jb21wICE9IG51bGwpIHN0YXRzQ3VtLnBhc3NpbmdfY29tcCArPSBnYW1lLnBhc3NpbmdfY29tcDtcbiAgICAgICAgICAgICAgICBpZiAoZ2FtZS5wYXNzaW5nX3lkcyAhPSBudWxsKSBzdGF0c0N1bS5wYXNzaW5nX3lkcyArPSBnYW1lLnBhc3NpbmdfeWRzO1xuICAgICAgICAgICAgICAgIGlmIChnYW1lLnBhc3NpbmdfdGQgIT0gbnVsbCkgc3RhdHNDdW0ucGFzc2luZ190ZCArPSBnYW1lLnBhc3NpbmdfdGQ7XG4gICAgICAgICAgICAgICAgaWYgKGdhbWUucGFzc2luZ19hdHQgIT0gbnVsbCkgc3RhdHNDdW0ucGFzc2luZ19hdHQgKz0gZ2FtZS5wYXNzaW5nX2F0dDtcbiAgICAgICAgICAgICAgICBpZiAoZ2FtZS5wYXNzaW5nX2ludCAhPSBudWxsKSBzdGF0c0N1bS5wYXNzaW5nX2ludCArPSBnYW1lLnBhc3NpbmdfaW50O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBmdW5jdGlvbiByYXRlKHN0YXRzKSB7XG4gICAgICAgICAgICAgICAgaWYgKHN0YXRzLnBhc3NpbmdfYXR0ICE9IG51bGwgJiYgc3RhdHMucGFzc2luZ19hdHQgIT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBmb3JtdWxhIGZyb20gaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvUGFzc2VyX3JhdGluZ1xuICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IChzdGF0c0N1bS5wYXNzaW5nX2NvbXAgLyBzdGF0c0N1bS5wYXNzaW5nX2F0dCAtIC4zKSAqIDU7XG4gICAgICAgICAgICAgICAgICAgIHZhciBiID0gKHN0YXRzQ3VtLnBhc3NpbmdfeWRzIC8gc3RhdHNDdW0ucGFzc2luZ19hdHQgLSAzKSAqIC4yNTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSAoc3RhdHNDdW0ucGFzc2luZ190ZCAvIHN0YXRzQ3VtLnBhc3NpbmdfYXR0KSAqIDIwO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IDIuMzc1IC0gKHN0YXRzQ3VtLnBhc3NpbmdfaW50IC8gc3RhdHNDdW0ucGFzc2luZ19hdHQgKiAyNSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhID4gMi4zNzUpIGEgPSAyLjM3NTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGEgPCAwKSBhID0gMDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGIgPiAyLjM3NSkgYiA9IDIuMzc1O1xuICAgICAgICAgICAgICAgICAgICBpZiAoYiA8IDApIGIgPSAwO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYyA+IDIuMzc1KSBjID0gMi4zNzU7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjIDwgMCkgYyA9IDA7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkID4gMi4zNzUpIGQgPSAyLjM3NTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQgPCAwKSBkID0gMDtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChhICsgYiArIGMgKyBkKSAvIDYgKiAxMDA7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwbGF5ZXIucmF0aW5nID0gcmF0ZShzdGF0c0N1bSk7XG4gICAgICAgICAgICByZXR1cm4gcGxheWVyO1xuICAgICAgICB9O1xuICAgICAgICAkc2NvcGUucmF0ZVBsYXllcnMgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciB3ZWVrID0gJCgnI3dlZWsycmF0ZScpLnZhbCgpLnNwbGl0KCcgJylbMV07XG4gICAgICAgICAgICB2YXIgcmF0ZWQgPSBbXTtcbiAgICAgICAgICAgICRzY29wZS5yYXRlZCA9IFtdO1xuICAgICAgICAgICAgYXBpU1ZDLmxvYWQoKS5zdWNjZXNzKGZ1bmN0aW9uKHBsYXllcnNPYmopIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUucGxheWVycyA9IHBsYXllcnNPYmouZGF0YS5wbGF5ZXJzO1xuICAgICAgICAgICAgICAgICRzY29wZS5nYW1lcyA9IHBsYXllcnNPYmouZGF0YS5nYW1lcztcbiAgICAgICAgICAgICAgICAkc2NvcGUuZ2FtZVN0YXRlcyA9IHBsYXllcnNPYmouZGF0YS53aW5zdG9uO1xuICAgICAgICAgICAgICAgIF8uZm9yRWFjaCgkc2NvcGUucGxheWVycywgZnVuY3Rpb24ocGxheWVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHBsYXllci5nYW1lcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBfLmZvckVhY2goJHNjb3BlLmdhbWVzLCBmdW5jdGlvbihnYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2FtZS5wbGF5ZXIgPT09IHBsYXllci5pZCkgcGxheWVyLmdhbWVzLnB1c2goZ2FtZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIF8uZm9yRWFjaCgkc2NvcGUucGxheWVycywgZnVuY3Rpb24ocGxheWVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjY3VtdWxhdGVTdGF0cyhwbGF5ZXIsd2Vlayk7XG4gICAgICAgICAgICAgICAgICAgIHJhdGVkLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJwbGF5ZXJcIjpwbGF5ZXIubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmF0aW5nXCI6TWF0aC5yb3VuZCgocGxheWVyLnJhdGluZyArIDAuMDAwMDEpICogMTAwKSAvIDEwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjpcInBcIitwbGF5ZXIuaWRcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB2YXIgcmFua2VkID0gXy5zb3J0QnkocmF0ZWQsIGZ1bmN0aW9uKHBsYXllcikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGxheWVyLnJhdGluZztcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByYW5rZWQgPSBfLmZpbHRlcihyYW5rZWQsIGZ1bmN0aW9uKHApe1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcC5yYXRpbmc7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgXy5mb3JFYWNoKHJhbmtlZC5yZXZlcnNlKCksZnVuY3Rpb24ocGxheWVyLCBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICBwbGF5ZXIucmFuayA9IGluZGV4ICsgMTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJhdGVkLnB1c2gocGxheWVyKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSk7XG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuIiwiYW5ndWxhci5tb2R1bGUoJ3dpbnN0b24nKVxuICAgIC5jb25maWcoWyckc3RhdGVQcm92aWRlcicsZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIsIHNlYXJjaFN2Yyl7XG4gICAgICAgIC8vIFRoZXNlIHN0YXRlcyBjb3JyZXNwb25kIHRvIHRoZSBwYWdlcyBvbiB0aGUgYXBwLiBIb29rcyB1cCB0ZW1wbGF0ZXMgYW5kIHZpZXdzXG4gICAgICAgICRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdob21lJyx7XG4gICAgICAgICAgICB1cmw6ICcvJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndXBkYXRlU3RhdHMuaHRtbCcsXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnbWFpbkNUUkwnLFxuICAgICAgICAgICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgICAgIHByZWxvYWRPYmo6IGZ1bmN0aW9uKCRodHRwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAkaHR0cCh7bWV0aG9kOidHRVQnLHVybDonL2FwaS9zdGF0cyd9KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgICAgICAvLy5zdGF0ZSgnc2VhcmNoJyx7XG4gICAgICAgICAgICAvLyAgICB1cmw6ICcvc2VhcmNoJyxcbiAgICAgICAgICAgIC8vICAgIHRlbXBsYXRlVXJsOiAnc2VhcmNoLmh0bWwnLFxuICAgICAgICAgICAgLy8gICAgY29udHJvbGxlcjogJ3NlYXJjaENUUkwnLFxuICAgICAgICAgICAgLy8gICAgcmVzb2x2ZToge1xuICAgICAgICAgICAgLy8gICAgICAgIC8vIFRoaXMgcXVlcmllcyB0aGUgc2VydmVyIGZvciBkaXN0aW5jdCBkZXBhcnRtZW50cyBhbmQgcHJlbG9hZHMgdGhlIGRlcGFydG1lbnRzIGRyb3AgZG93blxuICAgICAgICAgICAgLy8gICAgICAgIHByZWxvYWRPQko6IGZ1bmN0aW9uKCRodHRwKSB7XG4gICAgICAgICAgICAvLyAgICAgICAgICAgIHJldHVybiAkaHR0cCh7bWV0aG9kOidHRVQnLHVybDonL2FwaS9kZXBhcnRtZW50cyd9KTtcbiAgICAgICAgICAgIC8vICAgICAgICB9XG4gICAgICAgICAgICAvLyAgICB9XG4gICAgICAgICAgICAvL30pXG4gICAgICAgICAgICAvLy5zdGF0ZSgnZGV0YWlscycse1xuICAgICAgICAgICAgLy8gICAgLy8gVGhlIDppZCBpcyB0aGUgc3RyaW5nIHBhc3NlZCBpbiBmcm9tIHRoZSBVUkwgY29ycmVzcG9uZHMgdG8gdGhlIHBlcnNvbklEIGluIHRoZSB0aGUgZGF0YWJhc2VcbiAgICAgICAgICAgIC8vICAgIHVybDogJy9kZXRhaWxzLzppZCcsXG4gICAgICAgICAgICAvLyAgICB0ZW1wbGF0ZVVybDogJ2RldGFpbHMuaHRtbCcsXG4gICAgICAgICAgICAvLyAgICBjb250cm9sbGVyOiAnZGV0YWlsQ1RSTCdcbiAgICAgICAgICAgIC8vfSlcbiAgICB9XSlcbiAgICAucnVuKFsnJHN0YXRlJyxmdW5jdGlvbigkc3RhdGUpe1xuICAgICAgICAvLyBFdmVyeXRoaW5nIGluc2lkZSBoZXJlIHdpbGwgYmUgcnVuIG9uZSB0aW1lIG9uY2UgdGhlIGFwcCBoYXMgbG9hZGVkLiBHb29kIHBsYWNlIHRvIGluaXRpYWxpemUgYW55dGhpbmcgeW91IHdpbGwgYmUgdXNpbmdcbiAgICAgICAgJHN0YXRlLmdvKCdob21lJyk7XG4gICAgfV0pO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9